/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   disp_main.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: vboivin <marvin@42.fr>                     +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2017/03/29 19:32:18 by vboivin           #+#    #+#             */
/*   Updated: 2017/04/07 17:57:13 by vboivin          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "hFdF.h"

int				set_menu(void *p[2])
{
	int			coords[4];

	coords[XA] = 0;
	coords[YA] = TOP_M;
	coords[XB] = WIDTH;
	coords[YB] = HEIGHT;
	rekt_angle(p, coords, MENU_COLOR);
	return (0);
}

void			wipe_wi(void *p[2])
{
	int			coords[4];

	coords[XA] = 0;
	coords[YA] = 0;
	coords[XB] = WIDTH;
	coords[YB] = TOP_M;
	rekt_angle(p, coords, WALP_COLOR);
}

static t_seg	*set_seg(t_pt *pt_a, t_pt *pt_b, t_info *inf)
{
	t_seg		*outp;

	if (!(outp = malloc(T_SEG)))
		exits(1001);
	if (!pt_a || !pt_b)
	{
		free(outp);
		exits((!pt_a) ? 1002 : 1003);
	}
	outp->xa = (pt_a->x * D_P) * DEGSIN(inf->angle_x) + inf->margin_l;
	outp->ya = (pt_a->y * D_P) * DEGCOS(inf->angle_x) + inf->margin_t;
	outp->xb = (pt_b->x * D_P) * DEGSIN(inf->angle_x) + inf->margin_l;
	outp->yb = (pt_b->y * D_P) * DEGCOS(inf->angle_x) + inf->margin_t;
	return (outp);
}

void			draw_grid(t_info *inp)
{
	void		*p[2];
	t_pt		*scroll_v;
	t_pt		*scroll_h;

	p[WINID] = inp->wid;
	p[MLXID] = inp->mid;
//	wipe_wi(p);
	if (!inp)
		return ;
	scroll_v = inp->first_pt;
	scroll_h = scroll_v;
	while (scroll_v)
	{
		while (scroll_h)
		{
			if (scroll_h->b)
				ft_drawline(p, set_seg(scroll_h, scroll_h->b, inp), GRIDCOL);
			if (scroll_h->r)
				ft_drawline(p, set_seg(scroll_h, scroll_h->r, inp), GRIDCOL);
			scroll_h = scroll_h->r;
		}
//		printf("\n");
		scroll_v = scroll_v->b;
		scroll_h = scroll_v;
	}
//	set_menu(p);
}
